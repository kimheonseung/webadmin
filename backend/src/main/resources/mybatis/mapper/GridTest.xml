<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.devh.springboot.webadmin.mapper.GridTestMapper">
    <insert id="insertTestData" parameterType="java.util.List">
        INSERT INTO grid_test (col1, col2, col3)
        VALUES
        <foreach collection="list" item="item" separator=",">
            (#{item.col1}, #{item.col2}, #{item.col3})
        </foreach>
    </insert>

    <select id="selectAll" resultType="GridTest">
        SELECT * FROM grid_test
    </select>

    <select id="selectByPageSearch" resultType="GridTest" parameterType="com.devh.springboot.webadmin.common.paging.vo.PageSearchRequestVO">
        SELECT * FROM grid_test
        <include refid="whereSearchCondition">
            <property name="searchConditionVOList" value="searchConditionVOList" />
        </include>
        <if test="sortIndex != null and sortIndex.length > 0">
            ORDER BY ${sortIndex} ${sortOrder}
        </if>
        LIMIT #{offset}, #{rows}
    </select>

    <select id="selectCountAll" resultType="long" parameterType="com.devh.springboot.webadmin.common.paging.vo.PageSearchRequestVO">
        SELECT COUNT(*) FROM grid_test
        <include refid="whereSearchCondition">
            <property name="searchConditionVOList" value="searchConditionVOList" />
        </include>
    </select>

    <sql id="whereSearchCondition">
        <where>
            <if test="searchConditionVOList != null and searchConditionVOList.size > 0">
                <foreach collection="searchConditionVOList" item="searchConditionVO" separator=" AND ">
                    ${searchConditionVO.searchKey} = #{searchConditionVO.searchValue}
                </foreach>
            </if>
        </where>
    </sql>
</mapper>